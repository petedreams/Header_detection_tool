

<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>独自実装パケット検知ツールtkiwa</title>
  <link href="../css/base.css" rel="stylesheet" type="text/css">
  <script src="./api/html5media.min.js"></script>
  <style type="text/css">
    <!--
    li.ls {
      list-style: disc !important;
    }
    dl,dd,dt.ls {
      display: block !important;
      clear: none !important;
      float: none !important;
      width: auto !important;
    }
    dt.ls {
      padding-left: 1.0em;
    }
    dd.ls {
      padding-left: 2.0em;
    }
    .mal {
      text-align: center;
    }
    -->
  </style>
<link href="spybot_embed.css" rel="stylesheet" type="text/css">
</head>
<body>
  <a name="top"></a>
  <div id="wrap">
    <div id="container_sub">
      <div id="header_wrap">
        <div id="header">
          <img src="../img/header2.jpg" alt="横浜国立大学 情報・物理セキュリティグループ Information and Physical Security Research Group" width="560" height="90">
        </div>
        <div id="english">
          <p class="link_top">
          <a href="../index.html"><img src="../img/top_a.gif" alt="Top" name="Image32" width="70" height="20" border="0" id="Image32"></a>
          </p>
          <p class="link_group">
          <a href="../group.html"><img src="../img/group_a.gif" alt="グループのご紹介" name="Image33" width="135" height="20" border="0" id="Image33"></a>
          </p>
          <p class="link_english">
          <!-- <a href="../index_en.html"> --><img src="../img/english_a.gif" alt="English" name="Image30" width="70" height="20" border="0" id="Image30"><!-- </a> -->
          </p>
        </div>
        <div id="menu">
          <img src="../img/sub_spacer.jpg" width="1" height="30" border="0" class="img2">
          <p class="sub_research">
          <a href="../research.html"><img src="../img/sub_research_a.jpg" alt="研究内容" name="Image9" width="107" height="30" border="0" id="Image9"></a>
          </p>
          <p class="sub_members">
          <a href="../members.html"><img src="../img/sub_members_a.jpg" alt="メンバー" name="Image10" width="107" height="30" border="0" id="Image10"></a>
          </p>
          <p class="sub_outcome">
          <a href="../outcome.html"><img src="../img/sub_outcome_a.jpg" alt="研究成果" name="Image11" width="107" height="30" border="0" id="Image11"></a>
          </p>
          <p class="sub_lecture">
          <a href="../lecture.html"><img src="../img/sub_lecture_a.jpg" alt="講義" name="Image14" width="107" height="30" border="0" id="Image14"></a>
          </p>
          <p class="sub_event">
          <a href="../event.html"><img src="../img/sub_event_a.jpg" alt="イベント" name="Image15" width="107" height="30" border="0" id="Image15"></a>
          </p>	
          <p class="sub_link">
          <a href="../link.html"><img src="../img/sub_link_a.jpg" alt="リンク" name="Image12" width="107" height="30" border="0" id="Image12"></a>
          </p>
          <p class="sub_access">
          <a href="../access.html"><img src="../img/sub_access_a.jpg" alt="アクセス" name="Image13" width="107" height="30" border="0" id="Image13"></a>
          </p>
        </div> 
      </div> 
      <div id="contents_sub">
        <p>
          <a href="../index.html">TOP</a> 
          &gt; <a href="../outcome.html">研究成果</a>
          &gt; 独自実装パケット検知ツールtkiwa
        </p>
        <img src="../img/title_outcome.jpg" alt="研究成果"><br>
        <h1>独自実装パケット検知ツールtkiwa</h1>
        <h2>コンテンツ</h2>
        <ol>
          <li><a href="#intro">概要</a></li>
          <li><a href="#method">検知手法</a></li>
          <li><a href="#example">出力例</a></li>
          <li><a href="#download">ダウンロード</a></li>
          <li><a href="#ref">参考文献</a></li>
        </ol>

        <a name="intro"></a>
        <h2>概要</h2>
        <p>　tkiwaはOSの通信機能を使用せずに独自のネットワークスタックによって通信を行うマルウェアやツールを検知するCUIツールです。
        </p>
        <br>

        <a name="method"></a>
        <h2>検知手法</h2>
        <p>　OSの通信機能を用いた場合、通常パケット送信ごとに異なる値が設定されるシーケンス番号やIPヘッダのID値などの通信プロトコルの各ヘッダフィールドに着目し、固定値や一定のパターンが設定されているといった特徴を持つヘッダパターンをシグネチャとすることで、送信元のマルウェアやツールを特定します。
        </p>
        <br>
        <a name="example"></a>
        <h2>出力例</h2>
        
        <p><em><a href="https://zmap.io/">ZMap</a>によるTCPスキャンパケット</em></p>
        <pre><code><FONT color="#008000">$ headcap –r zmap_tcp.pcap

        &lt;&lt; [TCP S] 192.168.11.3:1234 -&gt; 192.168.11.1:80 &gt;&gt;  
        |  
        | date       = 2014-10-22 12:02:51.021105  
        | signature  = Zmap_tcp  
        | parameters = 54321(ipid):255(ttl):0(ipoff):3414890210(seq):0(ack):65535(win)  
        |  
        ---

        &lt;&lt; [TCP S] 192.168.11.3:4321 -&gt; 192.168.11.2:80 &gt;&gt;  
        |  
        | date       = 2014-10-22 12:02:51.021107  
        | signature  = Zmap_tcp  
        | parameters = 54321(ipid):255(ttl):0(ipoff):1611778721(seq):0(ack):65535(win)  
        |  
        ---  </FONT></code></pre>
        <p><em>マルウェアMortoによる3389/tcp宛通信</em></p>
        <pre><code><FONT color="#008000">$ headcap -r morto.pcap -lt

        2014-10-22 09:55:41.192224 [TCP S] 192.168.11.3:4935 -&gt; 192.168.11.1:3389 [Morto_scan]
        2014-10-22 09:55:42.123476 [TCP S] 192.168.11.3:4935 -&gt; 192.168.11.2:3389 [Morto_scan]</FONT></code></pre>
        <br>

        <a name="download"></a>
        <h2 id="down">ダウンロード</h2>
        <p><b>最新リリース:</b></p>
        <p>version1.0 : <a href="data/tkiwa-1.0.tar.gz">tkiwa-1.0.tar.gz</a></p>
        <br>
        <p><b>インストール・使用方法:</b></p>
        <p><a href="data/README.html">README</a></p>
        <br>
        <p><b>最新シグネチャデータ:</b></p>
        <p><a href="data/signature.json">signature.json</a>(version 1)</p>
        <br>
        <h2 id="ref">参考文献</h2>
        <ul>
        <li>[1] 小出 駿, 鈴木 将吾, 牧田 大佑, 村上 洸介, 笠間 貴弘, 島村 隼平, 衛藤 将史, 井上 大介, 吉岡 克成, 松本 勉, &quot;通信プロトコルのヘッダの特徴に基づく不正通信の検知・分類手法&quot;, 情報処理学会, コンピュータセキュリティシンポジウム(CSS) 2014.</li>
        </ul>

        <div id="pagetop">
          <p class="link_pagetop">
          <a href="#top"><img src="../img/pagetop_a.gif" alt="このページのトップへ" name="Image31" width="140" height="20" border="0" id="Image31"></a>
          </p>
        </div>
      </div>
      <div id="footer">
        <img src="../img/footer.gif" alt="情報・物理セキュリティグループ 		〒240-8501 神奈川県横浜市保土ヶ谷区常盤台79?7 横浜国立大学大学院環境情報研究院 		教員室：045-339-4133(松本) 045-339-4340(四方) 045-339-3690(吉岡) 		研究室：045-339-4134(松本) 045-339-4341(四方) 		Copyright(C) 2009 Information and Physical Security Research Group, All rights reserved." width="750" height="80"> 
      </div>
    </div>
  </div>

</body>
</html>

